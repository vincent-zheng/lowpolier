require=function e(t,n,r){function o(u,a){if(!n[u]){if(!t[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(i)return i(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[u]={exports:{}};t[u][0].call(l.exports,function(e){var n=t[u][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){(function(e){function t(e,t){for(var n=0,r=e.length-1;r>=0;r--){var o=e[r];"."===o?e.splice(r,1):".."===o?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return o.exec(e).slice(1)};n.resolve=function(){for(var n="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var u=i>=0?arguments[i]:e.cwd();if("string"!=typeof u)throw new TypeError("Arguments to path.resolve must be strings");u&&(n=u+"/"+n,o="/"===u.charAt(0))}return n=t(r(n.split("/"),function(e){return!!e}),!o).join("/"),(o?"/":"")+n||"."},n.normalize=function(e){var o=n.isAbsolute(e),i="/"===u(e,-1);return e=t(r(e.split("/"),function(e){return!!e}),!o).join("/"),e||o||(e="."),e&&i&&(e+="/"),(o?"/":"")+e},n.isAbsolute=function(e){return"/"===e.charAt(0)},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(r(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},n.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);for(var o=r(e.split("/")),i=r(t.split("/")),u=Math.min(o.length,i.length),a=u,s=0;u>s;s++)if(o[s]!==i[s]){a=s;break}for(var c=[],s=a;s<o.length;s++)c.push("..");return c=c.concat(i.slice(a)),c.join("/")},n.sep="/",n.delimiter=":",n.dirname=function(e){var t=i(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},n.basename=function(e,t){var n=i(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){return i(e)[3]};var u="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return 0>t&&(t=e.length+t),e.substr(t,n)}}).call(this,e("_process"))},{_process:2}],2:[function(e,t,n){function r(){l&&a&&(l=!1,a.length?c=a.concat(c):f=-1,c.length&&o())}function o(){if(!l){var e=setTimeout(r);l=!0;for(var t=c.length;t;){for(a=c,c=[];++f<t;)a&&a[f].run();f=-1,t=c.length}a=null,l=!1,clearTimeout(e)}}function i(e,t){this.fun=e,this.array=t}function u(){}var a,s=t.exports={},c=[],l=!1,f=-1;s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new i(e,t)),1!==c.length||l||setTimeout(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=u,s.addListener=u,s.once=u,s.off=u,s.removeListener=u,s.removeAllListeners=u,s.emit=u,s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],3:[function(e,t,n){var r;!function(){"use strict";function e(e){var t,n,r,o,i,u,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(t=e.length;t--;)e[t][0]<a&&(a=e[t][0]),e[t][0]>c&&(c=e[t][0]),e[t][1]<s&&(s=e[t][1]),e[t][1]>l&&(l=e[t][1]);return n=c-a,r=l-s,o=Math.max(n,r),i=a+.5*n,u=s+.5*r,[[i-20*o,u-o],[i,u+20*o],[i+20*o,u-o]]}function n(e,t,n,r){var o,u,a,s,c,l,f,d,h,v,g=e[t][0],p=e[t][1],m=e[n][0],w=e[n][1],y=e[r][0],b=e[r][1],_=Math.abs(p-w),x=Math.abs(w-b);if(i>_&&i>x)throw new Error("Eek! Coincident points!");return i>_?(s=-((y-m)/(b-w)),l=(m+y)/2,d=(w+b)/2,o=(m+g)/2,u=s*(o-l)+d):i>x?(a=-((m-g)/(w-p)),c=(g+m)/2,f=(p+w)/2,o=(y+m)/2,u=a*(o-c)+f):(a=-((m-g)/(w-p)),s=-((y-m)/(b-w)),c=(g+m)/2,l=(m+y)/2,f=(p+w)/2,d=(w+b)/2,o=(a*c-s*l+d-f)/(a-s),u=_>x?a*(o-c)+f:s*(o-l)+d),h=m-o,v=w-u,{i:t,j:n,k:r,x:o,y:u,r:h*h+v*v}}function o(e){var t,n,r,o,i,u;for(n=e.length;n;)for(o=e[--n],r=e[--n],t=n;t;)if(u=e[--t],i=e[--t],r===i&&o===u||r===u&&o===i){e.splice(n,2),e.splice(t,2);break}}var i=1/1048576;r={triangulate:function(t,r){var u,a,s,c,l,f,d,h,v,g,p,m,w=t.length;if(3>w)return[];if(t=t.slice(0),r)for(u=w;u--;)t[u]=t[u][r];for(s=new Array(w),u=w;u--;)s[u]=u;for(s.sort(function(e,n){return t[n][0]-t[e][0]}),c=e(t),t.push(c[0],c[1],c[2]),l=[n(t,w+0,w+1,w+2)],f=[],d=[],u=s.length;u--;d.length=0){for(m=s[u],a=l.length;a--;)h=t[m][0]-l[a].x,h>0&&h*h>l[a].r?(f.push(l[a]),l.splice(a,1)):(v=t[m][1]-l[a].y,h*h+v*v-l[a].r>i||(d.push(l[a].i,l[a].j,l[a].j,l[a].k,l[a].k,l[a].i),l.splice(a,1)));for(o(d),a=d.length;a;)p=d[--a],g=d[--a],l.push(n(t,g,p,m))}for(u=l.length;u--;)f.push(l[u]);for(l.length=0,u=f.length;u--;)f[u].i<w&&f[u].j<w&&f[u].k<w&&l.push(f[u].i,f[u].j,f[u].k);return l},contains:function(e,t){if(t[0]<e[0][0]&&t[0]<e[1][0]&&t[0]<e[2][0]||t[0]>e[0][0]&&t[0]>e[1][0]&&t[0]>e[2][0]||t[1]<e[0][1]&&t[1]<e[1][1]&&t[1]<e[2][1]||t[1]>e[0][1]&&t[1]>e[1][1]&&t[1]>e[2][1])return null;var n=e[1][0]-e[0][0],r=e[2][0]-e[0][0],o=e[1][1]-e[0][1],i=e[2][1]-e[0][1],u=n*i-r*o;if(0===u)return null;var a=(i*(t[0]-e[0][0])-r*(t[1]-e[0][1]))/u,s=(n*(t[1]-e[0][1])-o*(t[0]-e[0][0]))/u;return 0>a||0>s||a+s>1?null:[a,s]}},"undefined"!=typeof t&&(t.exports=r)}()},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=void 0;var r=e("delaunay-fast");n["default"]=r.triangulate},{"delaunay-fast":3}],5:[function(e,t,n){"use strict";function r(e){function t(e){return u[e],u[e+1],u[e+2]/3>>>0}for(var n=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1],r=e.width,u=(e.height,e.data),a=u.length,s=void 0,c=void 0,l=[],f=void 0,d=0;a>d;d+=4)l.push(t(d));var h=function(e){return l[e]};a/=4;for(var v=r+1,g=r-1,p=0;a>p;p++)s=o[0][0]*h(p-v)+o[0][1]*h(p-r)+o[0][2]*h(p-g)+o[1][0]*h(p-1)+o[1][1]*h(p)+o[1][2]*h(p-g)+o[2][0]*h(p+g)+o[2][1]*h(p+r)+o[2][2]*h(p+g),c=o[0][0]*h(p-v)+i[0][1]*h(p-r)+i[0][2]*h(p-g)+i[1][0]*h(p-1)+i[1][1]*h(p)+i[1][2]*h(p-g)+i[2][0]*h(p+g)+i[2][1]*h(p+r)+i[2][2]*h(p+g),f=Math.sqrt(s*s+c*c)>>>0,n(f,p%r,p/r>>0)}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r;var o=[[-1,0,1],[-2,0,2],[-1,0,1]],i=[[-1,-2,-1],[0,0,0],[1,2,1]]},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e,t,n,r){var o=void 0,i=void 0,u=void 0,a=void 0,s=void 0,c=void 0,l=void 0,f=void 0,d=t.width;t.height;e.save();for(var h=0;h<r.length;h+=3){o=n[r[h]][0],i=n[r[h+1]][0],u=n[r[h+2]][0],a=n[r[h]][1],s=n[r[h+1]][1],c=n[r[h+2]][1],l=(o+i+u)/3>>0,f=(a+s+c)/3>>0;var v=4*(d*f+l),g=t.data[v],p=t.data[v+1],m=t.data[v+2];e.fillStyle="rgba("+g+", "+p+", "+m+", "+t.data[v+3]+")",e.beginPath(),e.moveTo(o,a),e.lineTo(i,s),e.lineTo(u,c),e.fill()}e.restore()}},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(){for(var e=arguments.length<=0||void 0===arguments[0]?1e3:arguments[0],t=arguments.length<=1||void 0===arguments[1]?1:arguments[1],n=arguments.length<=2||void 0===arguments[2]?1:arguments[2],r=[],o=0;e>o;o++)r.push([t*Math.random()>>0,n*Math.random()>>0]);return r}},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e){return new Promise(function(t,n){var r=e.files[0];if(!/image\/\w+/.test(r.type))return void n(new Error("file is not image","readFile.js",5));var o=new FileReader;o.readAsDataURL(r),o.onload=function(e){t(o.result)}})}},{}],main:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var u=t[o](i),a=u.value}catch(s){return void n(s)}return u.done?void e(a):Promise.resolve(a).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}var i=e("./delaunay"),u=r(i),a=e("./module/getRamdonPoints"),s=(r(a),e("./module/readFile")),c=r(s),l=e("./module/draw"),f=r(l),d=e("./module/Sobel2"),h=r(d),v=e("path"),g=r(v);window.onload=function(){function e(e){loadingToast.querySelector(".weui_toast_content").innerText=e,loadingToast.style.display="block"}function t(){loadingToast.style.display="none"}function n(e){var n=this;r.width=e.width,r.height=e.height*r.width/e.width,i.drawImage(e,0,0,r.width,r.height);for(var s=i.getImageData(0,0,r.width,r.height),c=[],l=((0,h["default"])(s,function(e,t,n){e>30&&c.push([t,n])}),r.width,r.height,c.length/50>>>0),d=[],v=c.length,p=void 0,m=0;l>m;m+=1)p=Math.random()*v>>>0,d.push(c[p]);d.push([0,0],[0,r.height],[r.width,0],[r.width,r.height]);var w=(0,u["default"])(d);(0,f["default"])(i,s,d,w),t(),document.querySelector("#saveBtn").onclick||(document.querySelector("#saveBtn").onclick=o(regeneratorRuntime.mark(function y(){var e,t,o,u,s,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=a.files[0].type,t=i.getImageData(0,0,r.width,r.height).data,n.next=4,new Promise(function(e){r.toBlob(function(t){e(t)})});case 4:o=n.sent,u=(a.value.match(/(\/|\\)?[^(\/|\\)]+?\..+?$/)[0]||"").replace(/(\/|\\)/,""),s=g["default"].extname(u),u=u.replace(new RegExp(s+"$"),"-new.png"),c=document.createElement("a"),c.href=r.toDataURL(),c.download=u,l=document.createEvent("HTMLEvents"),c.style.display="none",document.body.appendChild(c),c.click(),c.remove();case 16:case"end":return n.stop()}},y,n)})),document.querySelector("#saveBtn").className="weui_btn weui_btn_primary")}document.oncontextmenu=function(){return!1};var r=paint,i=r.getContext("2d"),a=document.querySelector("#fileInput");a.onchange=o(regeneratorRuntime.mark(function s(){var t,r;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(a.files[0]){o.next=2;break}return o.abrupt("return");case 2:return e("正在生成，请耐心等待"),o.next=5,(0,c["default"])(a);case 5:t=o.sent,r=document.createElement("img"),r.onload=function(){n(r)},setTimeout(function(){r.src=t},50);case 9:case"end":return o.stop()}},s,void 0)})),document.querySelector("#selectBtn").onclick=function(){a.click()},function(){var e=document.createElement("img");e.onload=function(){r.width=e.width,r.height=e.height*r.width/e.width,i.drawImage(e,0,0,r.width,r.height),t()},e.onerror=function(){t()},e.src="res/img/test.jpg"}()}},{"./delaunay":4,"./module/Sobel2":5,"./module/draw":6,"./module/getRamdonPoints":7,"./module/readFile":8,path:1}]},{},["main"]);