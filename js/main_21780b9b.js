require=function e(t,n,r){function o(u,a){if(!n[u]){if(!t[u]){var l="function"==typeof require&&require;if(!a&&l)return l(u,!0);if(i)return i(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[u]={exports:{}};t[u][0].call(d.exports,function(e){var n=t[u][1][e];return o(n?n:e)},d,d.exports,e,t,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){var r;!function(){"use strict";function e(e){var t,n,r,o,i,u,a=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=Number.NEGATIVE_INFINITY;for(t=e.length;t--;)e[t][0]<a&&(a=e[t][0]),e[t][0]>c&&(c=e[t][0]),e[t][1]<l&&(l=e[t][1]),e[t][1]>d&&(d=e[t][1]);return n=c-a,r=d-l,o=Math.max(n,r),i=a+.5*n,u=l+.5*r,[[i-20*o,u-o],[i,u+20*o],[i+20*o,u-o]]}function n(e,t,n,r){var o,u,a,l,c,d,f,s,h,v,m=e[t][0],g=e[t][1],p=e[n][0],w=e[n][1],y=e[r][0],b=e[r][1],_=Math.abs(g-w),I=Math.abs(w-b);if(i>_&&i>I)throw new Error("Eek! Coincident points!");return i>_?(l=-((y-p)/(b-w)),d=(p+y)/2,s=(w+b)/2,o=(p+m)/2,u=l*(o-d)+s):i>I?(a=-((p-m)/(w-g)),c=(m+p)/2,f=(g+w)/2,o=(y+p)/2,u=a*(o-c)+f):(a=-((p-m)/(w-g)),l=-((y-p)/(b-w)),c=(m+p)/2,d=(p+y)/2,f=(g+w)/2,s=(w+b)/2,o=(a*c-l*d+s-f)/(a-l),u=_>I?a*(o-c)+f:l*(o-d)+s),h=p-o,v=w-u,{i:t,j:n,k:r,x:o,y:u,r:h*h+v*v}}function o(e){var t,n,r,o,i,u;for(n=e.length;n;)for(o=e[--n],r=e[--n],t=n;t;)if(u=e[--t],i=e[--t],r===i&&o===u||r===u&&o===i){e.splice(n,2),e.splice(t,2);break}}var i=1/1048576;r={triangulate:function(t,r){var u,a,l,c,d,f,s,h,v,m,g,p,w=t.length;if(3>w)return[];if(t=t.slice(0),r)for(u=w;u--;)t[u]=t[u][r];for(l=new Array(w),u=w;u--;)l[u]=u;for(l.sort(function(e,n){return t[n][0]-t[e][0]}),c=e(t),t.push(c[0],c[1],c[2]),d=[n(t,w+0,w+1,w+2)],f=[],s=[],u=l.length;u--;s.length=0){for(p=l[u],a=d.length;a--;)h=t[p][0]-d[a].x,h>0&&h*h>d[a].r?(f.push(d[a]),d.splice(a,1)):(v=t[p][1]-d[a].y,h*h+v*v-d[a].r>i||(s.push(d[a].i,d[a].j,d[a].j,d[a].k,d[a].k,d[a].i),d.splice(a,1)));for(o(s),a=s.length;a;)g=s[--a],m=s[--a],d.push(n(t,m,g,p))}for(u=d.length;u--;)f.push(d[u]);for(d.length=0,u=f.length;u--;)f[u].i<w&&f[u].j<w&&f[u].k<w&&d.push(f[u].i,f[u].j,f[u].k);return d},contains:function(e,t){if(t[0]<e[0][0]&&t[0]<e[1][0]&&t[0]<e[2][0]||t[0]>e[0][0]&&t[0]>e[1][0]&&t[0]>e[2][0]||t[1]<e[0][1]&&t[1]<e[1][1]&&t[1]<e[2][1]||t[1]>e[0][1]&&t[1]>e[1][1]&&t[1]>e[2][1])return null;var n=e[1][0]-e[0][0],r=e[2][0]-e[0][0],o=e[1][1]-e[0][1],i=e[2][1]-e[0][1],u=n*i-r*o;if(0===u)return null;var a=(i*(t[0]-e[0][0])-r*(t[1]-e[0][1]))/u,l=(n*(t[1]-e[0][1])-o*(t[0]-e[0][0]))/u;return 0>a||0>l||a+l>1?null:[a,l]}},"undefined"!=typeof t&&(t.exports=r)}()},{}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=void 0;var r=e("delaunay-fast");n["default"]=r.triangulate},{"delaunay-fast":1}],3:[function(e,t,n){"use strict";function r(e){function t(e){return u[e],u[e+1],u[e+2]/3>>>0}for(var n=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1],r=e.width,u=(e.height,e.data),a=u.length,l=void 0,c=void 0,d=[],f=void 0,s=0;a>s;s+=4)d.push(t(s));var h=function(e){return d[e]};a/=4;for(var v=r+1,m=r-1,g=0;a>g;g++)l=o[0][0]*h(g-v)+o[0][1]*h(g-r)+o[0][2]*h(g-m)+o[1][0]*h(g-1)+o[1][1]*h(g)+o[1][2]*h(g-m)+o[2][0]*h(g+m)+o[2][1]*h(g+r)+o[2][2]*h(g+m),c=o[0][0]*h(g-v)+i[0][1]*h(g-r)+i[0][2]*h(g-m)+i[1][0]*h(g-1)+i[1][1]*h(g)+i[1][2]*h(g-m)+i[2][0]*h(g+m)+i[2][1]*h(g+r)+i[2][2]*h(g+m),f=Math.sqrt(l*l+c*c)>>>0,n(f,g%r,g/r>>0)}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r;var o=[[-1,0,1],[-2,0,2],[-1,0,1]],i=[[-1,-2,-1],[0,0,0],[1,2,1]]},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e,t,n,r){var o=void 0,i=void 0,u=void 0,a=void 0,l=void 0,c=void 0,d=void 0,f=void 0,s=t.width;t.height;e.save();for(var h=0;h<r.length;h+=3){o=n[r[h]][0],i=n[r[h+1]][0],u=n[r[h+2]][0],a=n[r[h]][1],l=n[r[h+1]][1],c=n[r[h+2]][1],d=(o+i+u)/3>>0,f=(a+l+c)/3>>0;var v=4*(s*f+d),m=t.data[v],g=t.data[v+1],p=t.data[v+2];e.fillStyle="rgba("+m+", "+g+", "+p+", "+t.data[v+3]+")",e.beginPath(),e.moveTo(o,a),e.lineTo(i,l),e.lineTo(u,c),e.fill()}e.restore()}},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(){for(var e=arguments.length<=0||void 0===arguments[0]?1e3:arguments[0],t=arguments.length<=1||void 0===arguments[1]?1:arguments[1],n=arguments.length<=2||void 0===arguments[2]?1:arguments[2],r=[],o=0;e>o;o++)r.push([t*Math.random()>>0,n*Math.random()>>0]);return r}},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e){return new Promise(function(t,n){var r=e.files[0];if(!/image\/\w+/.test(r.type))return void n(new Error("file is not image","readFile.js",5));var o=new FileReader;o.readAsDataURL(r),o.onload=function(e){t(o.result)}})}},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e,t){var n=e.type,r="application/octet-stream";if(n&&n!=r){var o=e.slice||e.webkitSlice||e.mozSlice;e=o.call(e,0,e.size,r)}var i=URL.createObjectURL(e),u=document.createElementNS("http://www.w3.org/1999/xhtml","a");u.href=i,u.download=t;var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),u.dispatchEvent(a),URL.revokeObjectURL(i)}},{}],main:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var u=t[o](i),a=u.value}catch(l){return void n(l)}return u.done?void e(a):Promise.resolve(a).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}var i=e("./delaunay"),u=r(i),a=e("./module/getRamdonPoints"),l=(r(a),e("./module/readFile")),c=r(l),d=e("./module/draw"),f=r(d),s=e("./module/saveAs"),h=r(s),v=e("./module/Sobel2"),m=r(v);window.onload=function(){function e(e){loadingToast.querySelector(".weui_toast_content").innerText=e,loadingToast.style.display="block"}function t(){loadingToast.style.display="none"}document.oncontextmenu=function(){return!1};var n=paint,r=n.getContext("2d"),i=document.querySelector('input[type="file"]');i.onchange=o(regeneratorRuntime.mark(function a(){var o,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(i.files[0]){a.next=2;break}return a.abrupt("return");case 2:return e("正在生成，请耐心等待"),a.next=5,(0,c["default"])(i);case 5:o=a.sent,l=document.createElement("img"),l.onload=function(){n.width=l.width,n.height=l.height*n.width/l.width,r.drawImage(l,0,0,n.width,n.height);for(var e=r.getImageData(0,0,n.width,n.height),o=[],i=((0,m["default"])(e,function(e,t,n){e>30&&o.push([t,n])}),n.width,n.height,o.length/50>>>0),a=[],c=o.length,d=void 0,s=0;i>s;s+=1)d=Math.random()*c>>>0,a.push(o[d]);a.push([0,0],[0,n.height],[n.width,0],[n.width,n.height]);var h=(0,u["default"])(a);(0,f["default"])(r,e,a,h),t()},document.querySelector("#saveBtn").onclick||(document.querySelector("#saveBtn").onclick=function(){n.toBlob(function(e){(0,h["default"])(e,(i.value.match(/(\/|\\)[^(\/|\\)]+?\..+?$/)[0]||"").replace(/(\/|\\)/,""))})}),setTimeout(function(){l.src=o},50);case 10:case"end":return a.stop()}},a,void 0)})),document.querySelector("#selectBtn").onclick=function(){i.click()},function(){var e=document.createElement("img");e.onload=function(){n.width=e.width,n.height=e.height*n.width/e.width,r.drawImage(e,0,0,n.width,n.height),t()},e.onerror=function(){t()},e.src="res/img/test.jpg"}()}},{"./delaunay":2,"./module/Sobel2":3,"./module/draw":4,"./module/getRamdonPoints":5,"./module/readFile":6,"./module/saveAs":7}]},{},["main"]);